% 50 min
%非齐次亥姆霍兹方程 推迟势

波动方程为
\begin{equation}\label{RetPot_eq1}
{\laplacian}\Psi  - \frac{1}{{{c^2}}}\frac{{{\partial ^2}\Psi }}{{\partial {t^2}}} = f\left( {\vec r,t} \right)
\end{equation} 
用格林函数法求解，令格林函数满足
\begin{equation}\label{RetPot_eq2}
{\laplacian}G - \frac{1}{{{c^2}}}\frac{{{\partial ^2}G}}{{\partial {t^2}}} =  - \delta \left( {\vec r - \vec r'} \right)\delta \left( {t - t'} \right)
\end{equation} 
这个方程的意义是，如果在时刻 $t$， $\vec r$ 处出现一个极短的脉冲，会生成怎样的波函数 $G$． 求出 $G$ 以后，我们可以把非齐次项 $f\left( {\vec r,t} \right)$ 看成由许许多多这样的脉冲组成，对空间和时间进行积分．即可得到\autoref{RetPot_eq1} 的解．
\begin{equation}\label{RetPot_eq3}
\Psi \left( {\vec r,t} \right) = \int {\int {f\left( {\vec r',t'} \right)G\left( {\vec r,t,\vec r',t'} \right)\D V'} \D t'} 
\end{equation} 
下文用傅里叶变换法解\autoref{RetPot_eq2} 解出格林函数为
\begin{equation}\label{RetPot_eq4}
G\left( {\vec r,t,\vec r',t'} \right) = \frac{1}{{4\pi }}\frac{{\delta \left( {\left( {t - \left| {\vec r - \vec r'} \right|/c} \right) - t'} \right)}}{{\left| {\vec r - \vec r'} \right|}}
\end{equation} 
\autoref{RetPot_eq4}， \autoref{RetPot_eq3} 得\autoref{RetPot_eq1} 的解为
\begin{equation}\label{RetPot_eq5}
\Psi \left( {\vec r,t} \right) = \frac{1}{{4\pi }}\int {\frac{{f\left( {\vec r',t - \left| {\vec r - \vec r'} \right|/c} \right)}}{{\left| {\vec r - \vec r'} \right|}}\D V} 
\end{equation} 
\autoref{RetPot_eq5} 与静电场的势能公式很像，但是场源的时间做了修正．其中 $t - \left| {\vec r - \vec r'} \right|/c \equiv {t_{ret}}$ 定义为\textbf{推迟时间（ retarded time ）}， $\left| {\vec r - \vec r'} \right|/c$ 是波从 $\vec r'$ 到 $\vec r$ 所需的时间．也就是说，$f\left( {\vec r,t} \right)$ 并不能马上影响 $\Psi \left( {\vec r,t} \right)$，而是需要一个“信号传播时间” 才行．在静电场中，由于场源不随时间变化，所以不需要考虑时间延迟．

\subsection{具体过程}

\subsubsection{解格林函数}  

从物理意义上，要求格林函数在以 $\vec r'$ 为中心的任意方向都相同，即只是 $\left| {\vec r - \vec r'} \right|$ 的函数．以下为了方便，令 $R = \left| {\vec r - \vec r'} \right|$． 
由于等式右边除了原点外都是零，方程为齐次方程．齐次解为平面波
\begin{equation}
G\left( {\vec r,t} \right) = \sum {A\left( {\vec k,\omega } \right){e^{i\vec k \vdot \vec r}}{e^{i\omega t}}} 
\end{equation} 
求和是对所有满足 $\omega /k = c$ 和边界条件的 $\omega$ 和 $\vec k$ 求和（或积分）．但显然该解在原点不满足要求．为了排除原点，且满足对称性，以 $\vec r'$ 为原点建立球坐标，改用球坐标中的拉普拉斯方程，方程变为
\begin{equation}\label{RetPot_eq6}
\frac{1}{{{R^2}}}\frac{\D }{{\D r}}\left( {{R^2}\frac{{\D G}}{{\D R}}} \right) - \frac{1}{{{c^2}}}\frac{{{\D ^2}G}}{{\D {t^2}}} =  - \delta \left( {\vec r - \vec r'} \right)\delta \left( {t - t'} \right)
\end{equation} 
在 $R \ne 0$ 的条件下解齐次方程，首先分离变量，得到分离变量解
（提示: $\frac{1}{{{r^2}}}\frac{\D }{{\D r}}\left( {{r^2}\frac{{\D G}}{{\D r}}} \right) = \frac{1}{r}\frac{{{\D ^2}}}{{\D {r^2}}}\left( {rG} \right)$ ）
\begin{equation}\label{RetPot_eq7}
\frac{1}{R}\left[ {{C_1}\left( \omega  \right){e^{i\omega R/c}} + {C_2}\left( \omega  \right){e^{ - i\omega R/c}}} \right]{e^{i\omega t}}
\end{equation} 
所以通解为\autoref{RetPot_eq7} 对不同的 $\omega$ 求和．然而 $\omega$ 是连续的，所以改用傅里叶变换法解方程\autoref{RetPot_eq6} 
\begin{equation}\label{RetPot_eq8}
\left\{ \begin{array}{l}
A\left( {R,\omega } \right) = \int_{ - \infty }^{ + \infty } {G\left( {R,t,t'} \right){e^{i\omega t}}\D t} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} \\
G\left( {R,t,t'} \right) = \frac{1}{{2\pi }}\int_{ - \infty }^{ + \infty } {A\left( {R,\omega } \right){e^{ - i\omega t}}\D \omega } {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} 
\end{array} \right.
\end{equation} 
\autoref{RetPot_eq8} 就是\autoref{RetPot_eq7} 对连续 $\omega$ 的求和（积分）得到的通解，待定系数包含在 $A$ 里面，下面的\autoref{RetPot_eq11} 验证了这点．另外，\autoref{RetPot_eq6} 右边含时 $delta$ 函数的傅里叶变换为
\begin{equation}\label{RetPot_eq9}
\delta \left( {t - t'} \right) = \frac{1}{{2\pi }}\int_{ - \infty }^{ + \infty } {{e^{i\omega t'}}{e^{ - i\omega t}}\D \omega } 
\end{equation} 
\autoref{RetPot_eq8}， \autoref{RetPot_eq9} 代入方程\autoref{RetPot_eq6} 得到经过时间傅里叶变换的偏微分方程，与\autoref{RetPot_eq6} 等效． 
\begin{equation}\label{RetPot_eq10}
{\laplacian}A\left( {R,\omega } \right) + \frac{{{\omega ^2}}}{{{c^2}}}A\left( {R,\omega } \right) =  - {e^{i\omega t'}}\delta \left( {\vec r - \vec r'} \right)
\end{equation} 
注意这是关于位置的偏微分方程，$\omega$ 视为常数．解这条方程，就相当于解出了固定振动频率 $\omega$ 的波源所产生的同频率的波动方程．齐次解为
\begin{equation}\label{RetPot_eq11}
A\left( {R,\omega } \right) = \frac{1}{R}\left[ {{C_1}\left( \omega  \right){e^{i\omega R/c}} + {C_2}\left( \omega  \right){e^{ - i\omega R/c}}} \right]
\end{equation} 
（解方程提示: $\frac{1}{{{R^2}}}\frac{\D }{{\D R}}\left( {{R^2}\frac{{\D A}}{{\D R}}} \right) = \frac{1}{R}\frac{{{\D ^2}}}{{\D {R^2}}}\left( {RA} \right)$， 令 $\frac{1}{{{R^2}}}\frac{\D }{{\D R}}\left( {{R^2}\frac{{\D A}}{{\D R}}} \right) = \frac{1}{R}\frac{{{\D ^2}}}{{\D {R^2}}}\left( {RA} \right)$ ）\\
由于这是方程 $\vec r \ne \vec r'$ 的通解，而\autoref{RetPot_eq10} 的右边可以看做 $\vec r = \vec r'$ 时的边界条件，接下来利用边界条件找到适合的待定系数 ${C_1}\left( \omega  \right)$ 和 ${C_2}\left( \omega  \right)$．  
首先当 $\vec r \to \vec r'$ 时，$R \to 0$， $A \to \frac{{{C_1} + {C_2}}}{R}$． 所以
\begin{equation}
{\laplacian}A\left( {R,\omega } \right) = \left( {{C_1} + {C_2}} \right){\laplacian}\frac{1}{R} =  - 4\pi ({C_1} + {C_2})\delta \left( {\vec r - \vec r'} \right)
\end{equation} 
（关于 ${\laplacian}\frac{1}{R}$ 见空间狄拉克 $delta$ 函数，%链接未完成
）．代入\autoref{RetPot_eq10} 左边第一项，得
\begin{equation}
 - 4\pi ({C_1} + {C_2})\delta \left( {\vec r - \vec r'} \right) + \frac{{{\omega ^2}}}{{{c^2}}}A\left( {R,\omega } \right) =  - {e^{i\omega t'}}\delta \left( {\vec r - \vec r'} \right)
\end{equation} 
由于空间 delta 函数 $\delta \left( {\vec r - \vec r'} \right) \sim \frac{1}{{{R^3}}}$，所以相比之下 $\frac{{{\omega ^2}}}{{{c^2}}}A\left( {R,\omega } \right) \sim \frac{1}{R}$ 在 $R \to 0$ 时可以忽略不计．等式两边对比系数得
\begin{equation}
{C_1} + {C_2} = \frac{1}{{4\pi }}{e^{i\omega t'}}
\end{equation} 
再考虑\autoref{RetPot_eq11} 所代表的波函数分量，第一项代表波源向外传播的球形波，第二项代表向波源传播的，所以 ${C_2} = 0$， \autoref{RetPot_eq11} 变为
\begin{equation}
A\left( {R,\omega } \right) = \frac{1}{R}{C_1}\left( \omega  \right){e^{i\omega R/c}} = \frac{1}{{4\pi R}}{e^{i\omega t'}}{e^{i\omega R/c}}
\end{equation} 
现在可以把上式进行反傅里叶变换\autoref{RetPot_eq8} 得到格林函数
\begin{equation}
\begin{aligned}
G\left( {R,t,t'} \right) &= \frac{1}{{2\pi }}\int_{ - \infty }^{ + \infty } {A\left( {R,\omega } \right){e^{ - i\omega t}}d\omega }  = \frac{1}{{2\pi }}\int_{ - \infty }^{ + \infty } {\frac{1}{{4\pi R}}{e^{i\omega t'}}{e^{i\omega R/c}}\delta \left( {\vec r - \vec r'} \right){e^{ - i\omega t}}d\omega } \\
&= \frac{1}{{4\pi R}} \vdot \frac{1}{{2\pi }}\int_{ - \infty }^{ + \infty } {{e^{i\omega (t' + R/c - t)}}d\omega } \\
&= \frac{1}{{4\pi R}}\delta \left( {t - R/c - t'} \right)\\
&= \frac{1}{{4\pi }}\frac{{\delta \left( {\left( {t - \left| {\vec r - \vec r'} \right|/c} \right) - t'} \right)}}{{\left| {\vec r - \vec r'} \right|}}{\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} {\kern 1pt} (15)
\end{aligned}
\end{equation} 
这就是\autoref{RetPot_eq2} 的解\autoref{RetPot_eq4}． 

